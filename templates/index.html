<!DOCTYPE html>
<html>
<head>
    <title>Auto Usate</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Ricerca Auto Usate</h1>
    <form id="filtroForm">
        Marca: <input type="text" name="marca"><br>
        Modello: <input type="text" name="modello"><br>
        Alimentazione: 
        <select name="motore">
            <option value="">--</option>
            <option value="benzina">Benzina</option>
            <option value="diesel">Diesel</option>
        </select><br>
        Colore: <input type="text" name="colore"><br>
        <button type="submit">Cerca</button>
    </form>

    <div id="risultati"></div>

    <script>
        document.getElementById('filtroForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            fetch('/filtra_auto', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            })
            .then(resp => resp.json())
            .then(auto => {
                let html = '<table><tr><th>Marca</th><th>Modello</th><th>Motore</th><th>Colore</th><th>Immagine</th></tr>';
                auto.forEach(a => {
                    html += `<tr>
                        <td>${a.marca}</td>
                        <td>${a.modello}</td>
                        <td>${a.motore}</td>
                        <td>${a.colore}</td>
                        <td><img src="${a.immagine}" width="100"></td>
                    </tr>`;
                });
                html += '</table>';
                document.getElementById('risultati').innerHTML = html;
            });
        });
    </script>
</body>
</html>
